<style>
    .bg-critical{ background-color: #F12; }
    .bg-moderate{ background-color: #F72; }
    .bg-tolerable{ background-color: #FD2; }
    .no-resize{ resize: none; height: 100px !important;}
    .hide-detallado, .fl-hidden { display: none; }
    .show-detallado, .fl-visible{ display: block;}
</style>
<div class="page-head">
    <h2>{{header.findingTitle}}</h2>
    <div class="row">
        <div class="col-md-2 col-sm-6 col-sm-6" style="margin-top: 5px;">
            ID <span class="label label-default">{{header.findingID}}</span>
        </div>
        <div class="col-md-2 col-sm-6 col-sm-6" style="margin-top: 5px;">
            Tipo <span class="label label-default">{{header.findingType}}</span>
        </div>
        <div class="col-md-2  col-sm-12"  style="margin-top: 5px;">
            Criticidad <span class="label label-default"
                             style="{{header.findingValueColor}}">{{header.findingValue}} {{header.findingValueDescription}}</span>
        </div>
        <div class="col-md-2"  style="margin-top: 5px;">
            Vulnerabilidades <span class="label label-default">{{header.findingCount}}</span>
        </div>
        <div class="col-md-2"  style="margin-top: 5px;">
            Estado <span class="label label-default"
                         style="{{header.findingStateColor}}">{{header.findingState}}</span>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            <hr>
            Fecha de reporte: <b>{{finding.timestamp}}</b>
        </div>
    </div>
</div>
<div class="main-content">
    <h2 class="text-center"></h2>
    <div class="row">
        <div class="col-sm-12 col-md-12">
            <div class="tab-container">
                <ul class="nav nav-tabs">
                    <li class="active" style="font-size:15px;">
                        <a href="#home" data-toggle="tab" aria-expanded="false">
                        <i class="icon s7-note2" ></i>&nbsp;Información</a>
                    </li>
                    <li class="" style="font-size:15px;">
                        <a href="#tracking" data-toggle="tab" aria-expanded="true">
                        <i class="icon s7-graph1"></i>&nbsp;Tracking</a>
                    </li>
                    <li style="font-size:15px;">
                        <a href="#evidence" data-toggle="tab">
                        <i class="icon s7-photo"></i>&nbsp;Evidencia</a>
                    </li>
                </ul>
                <div class="tab-content">
                    <div id="home" class="tab-pane cont active">
                        <div class="row">
                            <div class="col-md-12 col-sm-12 col-xs-12">
                                <table class="table table-responsive" style="font-size: 14px;">
                                    <tbody>
                                        <tr>
                                            <td class="text-uppercase label-primary">
                                                <b style="color:white;">Proyecto Fluid</b>
                                            </td>
                                            <td class="text-left text-uppercase" colspan="3"><b>{{finding.proyecto_fluid}}</b></td> 
                                        </tr>    
                                        <tr>
                                            <td class="text-uppercase label-primary">
                                                <b style="color:white;">Proyecto Cliente</b>
                                            </td>
                                            <td class="text-left" colspan="3"><b>{{finding.proyecto_cliente}}</b></td>                                              
                                        </tr>
                                        <tr>
                                            <td class="text-uppercase label-primary">
                                                <b style="color:white;">Tipo Prueba</b>
                                            </td>
                                            <td class="text-left" colspan="3"><b>{{finding.tipo_prueba}}</b></td>                                          
                                        </tr>
                                        <tr class="text-left text-uppercase">
                                            <td colspan="4">Información del hallazgo</td>
                                        </tr>
                                        <tr>
                                            <td class="text-uppercase label-primary">
                                                <b style="color:white;">Título</b>
                                            </td>
                                            <td class="text-left" colspan="3"><b>{{finding.hallazgo}}</b></td>                                              
                                        </tr>
                                        <tr>
                                            <td class="text-uppercase label-primary">
                                                <b style="color:white;">Escenario</b>
                                            </td>
                                            <td class="text-left" colspan="3"><b>{{finding.escenario}}</b></td>                                                
                                            <td class="text-uppercase label-primary">
                                                <b style="color:white;">Actor</b>
                                            </td>
                                            <td class="text-left"><b>{{finding.actor}}</b></td>
                                        </tr>
                                        <tr ng-class="esDetallado">
                                            <td class="text-uppercase label-primary">
                                                <b style="color:white;">Categoria</b>
                                            </td>
                                            <td class="text-left" colspan="3"><b>{{finding.categoria}}</b></td>                                                
                                        </tr>
                                        <tr ng-class="esDetallado">
                                            <td class="text-uppercase label-primary">
                                                <b style="color:white;">Probabilidad</b>
                                            </td>
                                            <td class="text-left" colspan="3"><b>{{finding.probabilidad}}</b></td>                                                
                                        </tr>
                                        <tr ng-class="esDetallado">
                                            <td class="text-uppercase label-primary">
                                                <b style="color:white;">Severidad</b>
                                            </td>
                                            <td class="text-left" colspan="3"><b>{{finding.severidad}}</b></td>                                                
                                        </tr>
                                        <tr ng-class="esDetallado">
                                            <td class="text-uppercase label-primary">
                                                <b style="color:white;">Valor Riesgo</b>
                                            </td>
                                            <td class="text-left" colspan="3"><b>{{finding.valor_riesgo}}</b></td>                                                
                                        </tr>
                                        <tr>
                                            <td class="text-uppercase label-primary">
                                                <b style="color:white;">Descripción</b>
                                            </td>
                                            <td class="text-left" colspan="3"><b>{{finding.vulnerabilidad}}</b></td>                                              
                                        </tr>
                                        <tr>
                                            <td class="text-uppercase label-primary">
                                                <b style="color:white;">Requisito</b>
                                            </td>
                                            <td class="text-left" colspan="3"><b>{{finding.requisitos}}</b></td>                                              
                                        </tr>
                                        <tr>
                                            <td class="text-uppercase label-primary">
                                                <b style="color:white;">Amenaza</b>
                                            </td>
                                            <td class="text-left" colspan="3"><b>{{finding.amenaza}}</b></td>                                              
                                        </tr>
                                        <tr>
                                            <td class="text-uppercase label-primary">
                                                <b style="color:white;">Vulnerabilidades</b>
                                            </td>
                                            <td class="text-left" colspan="3"><b>{{finding.cardinalidad}}</b></td>                                              
                                        </tr>
                                        <tr>
                                            <td class="text-uppercase label-primary">
                                                <b style="color:white;">Dónde</b>
                                            </td>
                                            <td class="text-left" colspan="3">
                                                <textarea class="form-control" rows="6">
                                                    {{finding.donde}}
                                                </textarea>
                                            </td> 
                                        </tr>
                                        <tr>
                                            <td class="text-uppercase label-primary">
                                                <b style="color:white;">Vectores de ataque</b>
                                            </td>
                                            <td class="text-left"><b>{{finding.vector_ataque}}</b></td>                                              
                                            <td class="text-uppercase label-primary">
                                                <b style="color:white;">Recomendación</b>
                                            </td>
                                            <td class="text-left"><b>{{finding.solucion_efecto}}</b></td>                                              
                                        </tr>
                                        <tr>
                                            <td class="text-uppercase label-primary">
                                                <b style="color:white;">Sistemas Comprometidos</b>
                                            </td>
                                            <td class="text-left"><b>{{finding.sistema_comprometido}}</b></td>                                              
                                            <td class="text-uppercase label-primary">
                                                <b style="color:white;">Debilidad</b>
                                            </td>
                                            <td class="text-left"><b>{{finding.cwe}}</b></td>                                              
                                        </tr>
                                        <tr class="text-left text-uppercase">
                                            <td colspan="4">Calificación</td>
                                        </tr>
                                        <tr>
                                            <td class="text-uppercase label-primary">
                                                <b style="color:white;">Vector de Acceso</b>
                                            </td>
                                            <td class="text-left"><b>{{finding.vector_acceso}}</b></td>                                              
                                            <td class="text-uppercase label-primary">
                                                <b style="color:white;">Impacto Confidencialidad</b>
                                            </td>
                                            <td class="text-left"><b>{{finding.impacto_confidencialidad}}</b></td>                                              
                                        </tr>
                                        <tr>
                                            <td class="text-uppercase label-primary">
                                                <b style="color:white;">Autenticación</b>
                                            </td>
                                            <td class="text-left"><b>{{finding.autenticacion}}</b></td>                                              
                                            <td class="text-uppercase label-primary">
                                                <b style="color:white;">Impacto Integridad</b>
                                            </td>
                                            <td class="text-left"><b>{{finding.impacto_integridad}}</b></td>                                              
                                        </tr>
                                        <tr>
                                            <td class="text-uppercase label-primary">
                                                <b style="color:white;">Explotabilidad</b>
                                            </td>
                                            <td class="text-left"><b>{{finding.explotabilidad}}</b></td>                                              
                                            <td class="text-uppercase label-primary">
                                                <b style="color:white;">Impacto Disponibilidad</b>
                                            </td>
                                            <td class="text-left"><b>{{finding.impacto_disponibilidad}}</b></td>                                              
                                        </tr>
                                        <tr>
                                            <td class="text-uppercase label-primary">
                                                <b style="color:white;">Nivel Confianza</b>
                                            </td>
                                            <td class="text-left"><b>{{finding.nivel_confianza}}</b></td>                                              
                                            <td class="text-uppercase label-primary">
                                                <b style="color:white;">Nivel Resolución</b>
                                            </td>
                                            <td class="text-left"><b>{{finding.nivel_resolucion}}</b></td>                                              
                                        </tr>
                                        <tr>
                                            <td class="text-uppercase label-primary">
                                                <b style="color:white;">Complejidad Acceso</b>
                                            </td>
                                            <td class="text-left" colspan="3"><b>{{finding.complejidad_acceso}}</b></td>                                              
                                        </tr>
                                        <tr>
                                            <td class="text-uppercase label-primary">
                                                <b style="color:white;">CSSv2 Base</b>
                                            </td>
                                            <td class="text-left"><b>{{finding.cssv2base}}</b></td>                                              
                                            <td class="text-uppercase label-primary">
                                                <b style="color:white;">CSSv2 Temporal</b>
                                            </td>
                                            <td class="text-left"><b>{{finding.criticidad}}</b></td>                                              
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <!-- Begin Update View -->
                        <div class="row" style="display: none;">
                            <div class="col-md-3">
                                <label>Proyecto Fluid</label>
                                <input type="text" ng-model="finding.proyecto_fluid"
                                                   id="proyecto_fluid"
                                                   class="form-control" disabled>
                            </div>
                            <div class="col-md-3">
                                <label>Proyecto Cliente</label>
                                <input type="text" ng-model="finding.proyecto_cliente"
                                                   id="proyecto_cliente"
                                                   class="form-control" disabled>
                            </div>
                            <div class="col-md-6">
                                <label>Titulo</label>
                                <input type="text" ng-model="finding.hallazgo"
                                                   class="form-control">
                            </div>
                            <div class="col-md-4">
                                <label>Tipo de prueba</label>
                                <select ng-model="finding.tipo_prueba"
                                        class="form-control">
                                    <option ng-repeat="item in list.finding_test_type"
                                            value="{{item.name}}">
                                        {{item.name}}
                                    </option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label>Actor</label>
                                <select ng-model="finding.actor"
                                        class="form-control">
                                    <option ng-repeat="item in list.actor"
                                            value="{{item.name}}">{{item.name}}</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label>Escenario</label>
                                <select ng-model="finding.escenario"
                                        class="form-control">
                                    <option ng-repeat="item in list.scenario"
                                            value="{{item.name}}">{{item.name}}</option>
                                </select>
                            </div>
                            <div class="col-md-12">
                                <hr>
                            </div>
                            <div class="col-md-4" ng-class="esDetallado">
                                <div class="form-group">
                                    <label>Categoria</label>
                                    <select ng-model="finding.categoria"
                                            class="form-control">
                                        <option ng-repeat="item in list.categories"
                                                value="{{item.name}}">
                                            {{item.name}}
                                        </option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-3" ng-class="esDetallado">
                                <div class="form-group">
                                    <label>Probabilidad</label>
                                    <select ng-model="finding.probabilidad"
                                            ng-change="calculateSeveridad();"
                                            class="form-control">
                                        <option ng-repeat="item in list.probability"
                                                value="{{item.name}}">
                                            {{item.name}}
                                        </option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-2" ng-class="esDetallado">
                                <div class="form-group">
                                    <label>Severidad</label>
                                    <input type="text" class="form-control"
                                           ng-model="finding.severidad"
                                           ng-blur="calculateSeveridad();">
                                </div>
                            </div>
                            <div class="col-md-3"  ng-class="esDetallado">
                                <div class="form-group">
                                    <label>Valoración Riesgo</label>
                                    <input type="text" class="form-control"
                                           id="riesgo"
                                           ng-model="finding.valor_riesgo" disabled>
                                </div>
                            </div>
                            <div class="col-md-12" ng-class="esDetallado">
                                <hr>
                            </div>
                            <div class="col-md-12" ng-class="esDetallado">
                                <hr>
                            </div>
                            <div class="col-md-6">
                                <label>Descripcion</label>
                                <textarea class="form-control no-resize"
                                          ng-model="finding.vulnerabilidad">{{finding.vulnerabilidad}}</textarea>
                            </div>
                            <div class="col-md-6">
                                <label>Amenaza</label>
                                <textarea class="form-control no-resize"
                                          row="8">{{finding.amenaza}}</textarea>
                            </div>
                            <div class="col-md-6">
                                <label>Donde</label>
                                <textarea class="form-control no-resize" style="height: 170px !important;"
                                          >{{finding.donde}}</textarea>
                            </div>
                            <div class="col-md-6">
                                <label>Vulnerabilidades</label>
                                <input class="form-control"
                                       type="number" step="1"
                                       ng-model="finding.cardinalidad">
                            </div>
                            <div class="col-md-6">
                                <label>Requisito</label>
                                <textarea class="form-control no-resize"
                                          row="8">{{finding.requisitos}}</textarea>
                            </div>
                            <div class="col-md-6">
                                <label>Recomendación</label>
                                <textarea class="form-control no-resize"
                                          row="8">{{finding.solucion_efecto}}</textarea>
                            </div>
                            <div class="col-md-6" ng-class="esDetallado">
                                <label>Riesgo</label>
                                <textarea class="form-control no-resize"
                                          row="8">{{finding.riesgo}}</textarea>
                            </div>
                            <div class="col-md-6" ng-class="esGeneral">
                                <div class="form-group">
                                    <label>Vectores de ataque</label>
                                    <textarea class="form-control no-resize"
                                              rows="8">{{finding.vector_ataque}}</textarea>
                                </div>
                            </div>
                            <div class="col-md-6" ng-class="esGeneral">
                                <div class="form-group">
                                    <label>Sistemas comprometidos</label>
                                    <textarea class="form-control no-resize"
                                              rows="8">{{finding.sistema_comprometido}}</textarea>
                                </div>
                            </div>
                            <div class="col-md-6" ng-class="esGeneral">
                                <div class="form-group">
                                    <label>Debilidad</label>
                                    <a href="{{finding.cwe}}" target="_blank" class="form-control no-resize">{{finding.cwe}}</a>
                                </div>
                            </div>
                            <div class="col-md-12">
                                <hr>
                            </div>
                            <div class="col-md-5">
                                <label>Vector de acceso</label>
                                <select ng-model="finding.vector_acceso"
                                        ng-change="calculteCSSv2();"
                                        class="form-control">
                                    <option ng-repeat="item in list.accessVector"
                                            value="{{item.value + ' | ' + item.name}}">
                                        {{item.name}}
                                    </option>
                                </select>
                            </div>
                            
                            <div class="col-md-7">
                                <label>Impacto a la Integridad</label>
                                <select ng-model="finding.impacto_integridad"
                                        ng-change="calculteCSSv2();"
                                        class="form-control">
                                    <option ng-repeat="item in list.integrity"
                                            value="{{item.value + ' | ' + item.name}}">
                                        {{item.name}}
                                    </option>
                                </select>
                            </div>
                            <div class="col-md-5">
                                <label>Autenticación</label>
                                <select ng-model="finding.autenticacion"
                                        ng-change="calculteCSSv2();"
                                        class="form-control">
                                    <option ng-repeat="item in list.authentication"
                                            value="{{item.value + ' | ' + item.name}}">
                                            {{item.name}}
                                    </option>
                                </select>
                            </div>
                            <div class="col-md-7">
                                <label>Impacto a la Confidencialidad</label>
                                <select ng-model="finding.impacto_confidencialidad"
                                        ng-change="calculteCSSv2();"
                                        
                                        class="form-control">
                                    <option ng-repeat="item in list.confidenciality"
                                            value="{{item.value + ' | ' + item.name}}">
                                        {{item.name}}
                                    </option>
                                </select>
                            </div>
                            <div class="col-md-5">
                                <label>Nivel de resolución</label>
                                <select ng-model="finding.nivel_resolucion"
                                        ng-change="calculteCSSv2();"
                                        class="form-control">
                                    <option ng-repeat="item in list.resolutionLevel"
                                            value="{{item.value + ' | ' + item.name}}">
                                        {{item.name}}
                                    </option>
                                </select>
                            </div>
                            
                            <div class="col-md-7">
                                <label>Impacto a la disponibilidad</label>
                                <select ng-model="finding.impacto_disponibilidad"
                                        ng-change="calculteCSSv2();"
                                        class="form-control">
                                    <option ng-repeat="item in list.availability"
                                            value="{{item.value + ' | ' + item.name}}">
                                        {{item.name}}
                                    </option>
                                </select>
                            </div>
                            <div class="col-md-5">
                                <label>Explotabilidad</label>
                                <select ng-model="finding.explotabilidad"
                                        ng-change="calculteCSSv2();"
                                        class="form-control">
                                    <option ng-repeat="item in list.explotability"
                                            value="{{item.value + ' | ' + item.name}}">
                                            {{item.name}}
                                    </option>
                                </select>
                            </div>
                            <div class="col-md-7">
                                <label>Complejidad de acceso</label>
                                <select ng-model="finding.complejidad_acceso"
                                        ng-change="calculteCSSv2();"
                                        class="form-control">
                                    <option ng-repeat="item in list.accessComplexity"
                                            value="{{item.value + ' | ' + item.name}}">
                                        {{item.name}}
                                    </option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label>Nivel de confianza</label>
                                <select ng-model="finding.nivel_confianza"
                                        ng-change="calculteCSSv2();"
                                        class="form-control">
                                    <option ng-repeat="item in list.realiabilityLevel"
                                            value="{{item.value + ' | ' + item.name}}">
                                        {{item.name}}
                                    </option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label>CSSv2 Base</label>
                                <input type="text"
                                       class="form-control"
                                       id="cssv2base"
                                       ng-model="finding.cssv2base">
                            </div>
                            <div class="col-md-3">
                                <label>CSSv2 Temporal</label>
                                <input type="text"
                                       class="form-control"
                                       id="criticidad"
                                       ng-model="finding.criticidad">
                            </div>
                            <div class="col-md-12">
                                <hr>
                            </div>
                        </div>
                        <div class="row">
                            <div class="{{colsBack}}">
                                <button class="btn btn-default btn-block"
                                        onclick="window.close();"
                                        ng-click="window.close();">Cerrar</button>
                            </div>
                            <div class="{{colsEnable}}">
                                <button class="btn btn-default btn-block"
                                        ng-class="enable"
                                        ng-click="enableUpdate()">Hacer Editable</button>
                            </div>
                            <div class="{{colsUpdateable}}">
                                <button class="btn btn-primary btn-block"
                                        ng-class="updateable"
                                        ng-click="updateFinding()">Actualizar</button>
                            </div>
                        </div>
                    </div>
                    <div id="tracking" class="tab-pane cont">
                        <div class="row">
                            <div class="col-md-12">
                                <p>Vulnerabilidades Abiertas</p>
                                <textarea class="form-control" rows="4" disabled>{{finding.donde}}</textarea>
                            </div>
                            <div class="col-md-12">
                                <p>Vulnerabilidades Cerradas</p>
                                <textarea class="form-control" rows="4" disabled>{{finding.cerradas}}</textarea>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <ul class="timeline">
                                    <li class="timeline-item text-left">
                                        <div class="timeline-date"><span>{{finding.timestamp}}</span></div>
                                        <div class="timeline-content">
                                            <table class="table table-bordered table-responsive" style="max-width: 350px;">
                                                <tr class="text-center">
                                                    <td colspan="2"><b>Hallazgo reportado</b></td>
                                                </tr>
                                            </table>
                                        </div>
                                    </li>
                                    <li class="timeline-item" ng-repeat="x in finding.cierres">
                                        <div class="timeline-date"><span>{{x.timestamp}} </span></div>
                                        <div class="timeline-content">
                                            <table class="table table-bordered table-responsive" style="max-width: 350px;">
                                                <tr class="text-center">
                                                    <td colspan="2"><b>Ciclo de cierre {{x.position}}</b></td>
                                                </tr>
                                                <tr>
                                                    <td>Vulnerabilidades Abiertas</td>
                                                    <td>{{x.abiertas}}</td>
                                                </tr>
                                                <tr>
                                                    <td>Vulnerabilidades Cerradas</td>
                                                    <td>{{x.cerradas}}</td>
                                                </tr>
                                            </table>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div id="evidence" class="tab-pane">
                        <div class="row" ng-repeat="ev in tabEvidences">
                            <div class="col-md-6 text-center">
                                <div mag-thumb="inner-inline" mag-flow="inline">
                                    <img src="{{ev.url}}"
                                         style="max-width:100%;" 
                                         class="img-thumbnail img-responsive integrates-image"
                                         width="600" height="600"/>
                                </div>
                            </div>
                            <div class="col-md-6">
                                Detalle:<br><h3>{{ev.desc}}</h3>
                            </div>
                            <div class="col-md-12">
                                <hr>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- START: MODAL ACTUALIZAR -->
    <script type="text/ng-template" id="update.html">
        <div class="modal-header">
            <h3 class="modal-title" id="modal-title">Actualizar Hallazgo</h3>
        </div>
        <div class="modal-body" id="modal-body">
            ¿Esta seguro?
        </div>
        <div class="modal-footer">
            <button class="btn btn-warning" type="button" ng-click="closeModal()">Cerrar</button>
            <button class="btn btn-primary" type="button" ng-click="okModal()">Confirmar</button>
        </div>
    </script>
</div>
